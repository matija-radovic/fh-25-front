import { useInView } from "motion/react";
import { memo, useEffect, useRef } from "react";
import Warp, { Transformer } from "warpjs";

const deltaT = 32;

const ZeppelinBanner2 = memo(() => {
    const flagRef = useRef<SVGSVGElement | null>(null);
    const warpRef = useRef<Warp | null>(null);
    const inView = useInView(flagRef);

    useEffect(() => {
        if (!warpRef.current || !inView) return;

        let af: number;
        let offset = 0;
        let lasttime = 0;
        const transform: Transformer = ([x, , oy]: number[]) => [x, oy + 2 * Math.sin(x / 96 - offset), oy]
        const warp = warpRef.current;

        function animate(currentTime: number) {
            if (currentTime - lasttime >= deltaT) {
                lasttime = currentTime;
                warp.transform(transform);
                offset += 0.125
            }
            af = requestAnimationFrame(animate);
        }
        animate(0);

        return () => cancelAnimationFrame(af);
    }, [inView])

    const initref = (node: SVGSVGElement | null) => {
        flagRef.current = node;
        if (!node) {
            warpRef.current = null;
        } else {
            warpRef.current = new Warp(node);
            warpRef.current.transform(([x, y]) => [x, y, y])
        }
    }

    return (
        <svg ref={initref}
            width="730" height="334" viewBox="0 0 730 334" fill="none" xmlns="http://www.w3.org/2000/svg"
        >
            <path d="M0 309V31L91.25 27.125L182.5 23.25L273.75 19.375L365 15.5L456.25 11.625L547.5 7.75L638.75 3.875L730 0V340L638.75 336.125L547.5 332.25L456.25 328.375L365 324.5L273.75 320.625L182.5 316.75L91.25 312.875L0 309Z" fill="#002440" />
            <g fill="#24BDDE">
                <path fillRule="evenodd" clipRule="evenodd" d="M128.449 184.195V131.995C128.449 131.995 129.894 123.588 133.5 120.013C136.973 116.57 145.009 115.075 145.009 115.075H197.449C197.449 115.075 205.485 116.57 208.958 120.013C212.565 123.588 214.009 131.995 214.009 131.995V184.195C214.009 184.195 212.573 192.688 208.958 196.335C205.493 199.831 197.449 201.475 197.449 201.475H145.009C145.009 201.475 136.965 199.831 133.5 196.335C129.885 192.688 128.449 184.195 128.449 184.195ZM198.289 184.915H151.369L198.289 145.795V184.915ZM191.089 131.155L144.169 170.275V131.155H191.089Z" />
                <path d="M28.8398 201.475V168.355C28.8398 168.355 30.2791 160.006 33.889 156.5C37.3727 153.117 45.3998 151.795 45.3998 151.795H98.6798V130.795H44.5598V138.115H28.8398V131.635C28.8398 131.635 30.2006 123.493 33.6639 120C37.1634 116.47 45.3998 115.075 45.3998 115.075H97.8398C97.8398 115.075 106.13 116.446 109.636 120C113.084 123.496 114.4 131.635 114.4 131.635V151.075C114.4 151.075 113.047 159.133 109.636 162.618C106.134 166.196 97.8398 167.635 97.8398 167.635H44.5598V185.755H114.4V201.475H28.8398Z" />
                <path d="M228.527 201.475V168.355C228.527 168.355 229.884 160.225 233.338 156.733C236.838 153.195 245.087 151.795 245.087 151.795H298.367V130.795H244.247V138.115H228.527V131.635C228.527 131.635 229.884 123.505 233.338 120.013C236.838 116.475 245.087 115.075 245.087 115.075H297.527C297.527 115.075 305.83 116.45 309.337 120.013C312.776 123.508 314.087 131.635 314.087 131.635V151.075C314.087 151.075 312.739 159.121 309.337 162.605C305.834 166.191 297.527 167.635 297.527 167.635H244.247V185.755H314.087V201.475H228.527Z" />
                <path d="M328.137 184.915V179.275H343.857V185.755H397.977V165.355H328.137V115.075H413.697V130.795H343.857V149.515H397.137C397.137 149.515 405.333 150.875 408.832 154.37C412.334 157.869 413.697 166.075 413.697 166.075V184.915C413.697 184.915 412.285 193.014 408.832 196.5C405.338 200.026 397.137 201.475 397.137 201.475H344.697C344.697 201.475 336.495 200.026 333.002 196.5C329.548 193.014 328.137 184.915 328.137 184.915Z" />
            </g>
            <g fill="#F3F2FF">
                <path d="M429.9 151.476V115.476H463.15V123.276H437.75V129.576H458.2V137.376H437.75V151.476H429.9Z" fill="#F3F2FF" />
                <path d="M507.339 151.476V115.476H515.339L535.489 139.476V115.476H543.339V151.476H535.339L515.089 127.376V151.476H507.339Z" fill="#F3F2FF" />
                <path d="M429.85 201.476V165.476H437.6V179.576H458.85V165.476H466.6V201.476H458.85V187.376H437.6V201.476H429.85Z" fill="#F3F2FF" />
                <path d="M514.176 201.476V165.476H521.976V179.576H529.026L540.826 165.476H548.926V168.176L536.076 183.476L548.926 198.776V201.476H540.826L529.026 187.376H521.976V201.476H514.176Z" fill="#F3F2FF" />
                <path d="M606.895 201.476V173.276H592.795V165.476H628.795V173.276H614.695V201.476H606.895Z" fill="#F3F2FF" />
                <path d="M673.94 201.476V165.476H681.94L702.09 189.476V165.476H709.94V201.476H701.94L681.69 177.376V201.476H673.94Z" />
            </g>
            <g fillRule="evenodd" clipRule="evenodd" fill="#F3F2FF">
                <path d="M465.832 144.076V122.876C465.832 118.5 468.5 115.476 473.232 115.476H494.432C500 115.476 501.832 117.5 501.832 122.876V144.076C501.832 149 500 151.476 494.432 151.476H473.232C467 151.476 465.832 150 465.832 144.076ZM493.982 143.676H473.582V123.276H493.982V143.676Z" />
                <path d="M472.429 201.476V172.876C472.429 168 475 165.476 479.829 165.476H500.979C506 165.476 508.429 167.5 508.429 172.876V201.476H500.579V189.876H480.179V201.476H472.429ZM500.579 182.076H480.179V173.276H500.579V182.076Z" />
                <path d="M552.898 201.476V172.876C552.898 168.176 555 165.476 560.298 165.476H581.448C586.5 165.476 588.898 168 588.898 172.876V201.476H581.048V189.876H560.648V201.476H552.898ZM581.048 182.076H560.648V173.276H581.048V182.076Z" />
                <path d="M632.434 194.076V172.876C632.434 168 634.5 165.476 639.834 165.476H661.034C666 165.476 668.434 168 668.434 172.876V194.076C668.434 199 666 201.476 661.034 201.476H639.834C634.5 201.476 632.434 199.5 632.434 194.076ZM660.584 193.676H640.184V173.276H660.584V193.676Z" />
            </g>
            <path d="M71.9216 214.617L71.9224 230.051C71.9224 230.051 71.9224 240.704 62.3555 240.704C52.7886 240.704 52.7894 230.051 52.7894 230.051V214.617M544.478 239.347C539.216 242.415 536.207 238.993 536.207 235.863V222.488M551.233 213C551.233 213 551.233 223.416 551.233 230.09M44.5878 234.862L29 228.088L44.5878 221.314M79.0483 238.172C87 242.5 94 239.5 94 236.5C94 233.5 91.5 231.437 87 231.437C82.5 231.437 79.5448 229.584 80.8152 225.308C82.7833 220.48 90.555 221.93 93.5881 224.143M115.304 237.556C113.422 238.993 111.305 240.535 107.605 240.535C101.989 240.535 99.0144 236.855 99.0144 231.437M99.0144 231.437H115.837C115.837 228.567 114.269 222.287 107.605 222.287C102.412 222.287 99.0131 226.602 99.0144 231.437ZM128.709 246.351C133.5 249.5 135.81 249.303 139.49 241.559M148.318 221.352C148.318 221.352 142.893 234.399 139.49 241.559M130.481 221.352L139.49 241.559M177.961 221.352V233.092C177.961 233.092 177.637 240.79 185.336 240.79C193.034 240.79 193.458 233.092 193.458 233.092M193.458 233.092L193.511 221.352M193.458 233.092L193.511 242M203.701 221.352L203.73 231.456M203.73 242V231.456M212.514 223.17C206.585 223.17 203.73 231.456 203.73 231.456M242.579 226.591C241.309 224.025 238.696 222.654 235.985 222.468C231.061 222.131 227.001 226.452 226.991 231.437C226.98 236.432 231.05 240.782 235.985 240.443C238.695 240.257 241.309 238.993 242.579 236.427M289.557 231.321C289.547 226.368 285.581 222.342 280.677 222.353C275.783 222.364 271.845 226.379 271.835 231.321C271.824 236.274 275.773 240.317 280.677 240.328C285.592 240.338 289.568 236.285 289.557 231.321ZM289.557 231.321V242M289.557 231.321V213M314.015 237.556C312.134 238.993 310.016 240.535 306.316 240.535C300.7 240.535 297.726 236.855 297.726 231.437M297.726 231.437H314.548C314.548 228.567 312.98 222.287 306.316 222.287C301.123 222.287 297.724 226.602 297.726 231.437ZM333.328 216.887V222.488M341.598 239.346C336.336 242.414 333.328 238.993 333.328 235.863V222.488M340.779 222.488H333.328M333.328 222.488H328.392M395.065 226.591C393.795 224.025 391.182 222.654 388.471 222.468C383.546 222.131 379.487 226.452 379.476 231.437C379.466 236.432 383.536 240.782 388.471 240.443C391.18 240.257 393.795 238.993 395.065 236.427M402.693 213C402.693 213 402.693 223.416 402.693 230.089M402.693 241.559C402.693 241.559 402.693 234.569 402.693 230.089M418.433 241.559V230.089C418.433 225.278 415.822 222.468 411.058 222.468C406.294 222.468 402.693 226.591 402.693 230.089M492.596 221.352C492.596 221.352 492.596 227.193 492.596 230.936M475.216 245.062C475.216 245.062 478.875 247.974 483.792 247.974C493.116 247.974 492.596 239.442 492.596 239.442C492.596 239.442 492.596 234.258 492.596 230.936M492.596 230.936C492.386 235.832 488.492 239.614 483.639 239.635C478.765 239.656 474.563 235.858 474.607 230.936C474.65 226.055 478.806 222.371 483.639 222.391C488.451 222.412 492.302 226.086 492.596 230.936ZM442.85 241.559V234.824M442.85 231.148C443 224.5 440.218 222.391 436.028 222.391C431.326 222.391 428.482 224.913 428.482 224.913M442.85 231.148H435.075C432.979 231.106 428.785 231.99 428.785 235.863C428.785 239.736 432.979 240.607 435.075 240.559C436.936 240.623 441.095 239.566 442.85 234.824M442.85 231.148V234.824M451.498 241.521L451.465 230.051M451.44 221.314L451.465 230.051M467.238 241.521V230.051C467.238 225.894 465.506 222.391 459.863 222.391C451.68 222.391 451.465 230.051 451.465 230.051M516.895 237.556C515.013 238.993 512.896 240.535 509.196 240.535C503.58 240.535 500.606 236.855 500.606 231.437M500.606 231.437H517.428C517.428 228.567 515.86 222.287 509.196 222.287C504.003 222.287 500.604 226.602 500.606 231.437ZM536.207 216.887V222.488M543.658 222.488H536.207M536.207 222.488H531.272M551.233 241.559C551.233 241.559 551.233 234.569 551.233 230.09M566.973 241.559V230.09C566.973 225.278 564.363 222.469 559.599 222.469C554.835 222.469 551.233 226.591 551.233 230.09M591.109 237.556C589.228 238.993 587.11 240.535 583.41 240.535C577.794 240.535 574.82 236.855 574.82 231.437M574.82 231.437H591.643C591.643 228.567 590.075 222.287 583.41 222.287C578.218 222.287 574.819 226.602 574.82 231.437ZM609.907 221.352L609.936 231.456M609.936 242V231.456M618.72 223.17C612.791 223.17 609.936 231.456 609.936 231.456M661.042 241.559V234.824M661.042 231.148C661.042 224.5 659 222.391 654.22 222.391C649.517 222.391 646.674 224.913 646.674 224.913M661.042 231.148H653.267C651.17 231.106 646.976 231.99 646.976 235.863C646.976 239.736 651.17 240.607 653.267 240.559C655.127 240.623 659.286 239.566 661.042 234.824M661.042 231.148V234.824M686.628 231.321C686.618 226.368 682.653 222.342 677.748 222.353C672.854 222.364 668.917 226.379 668.906 231.321C668.896 236.274 672.844 240.317 677.748 240.328C682.663 240.338 686.639 236.285 686.628 231.321ZM686.628 231.321V241.987M686.628 231.321V213M694.412 234.862L710 228.088L694.412 221.314M161.06 240.443C156.156 240.433 152.208 236.39 152.218 231.437C152.229 226.494 156.166 222.479 161.06 222.468C165.964 222.458 169.93 226.484 169.94 231.437C169.951 236.4 165.975 240.454 161.06 240.443ZM256.973 240.328C252.069 240.317 248.121 236.274 248.131 231.321C248.142 226.379 252.079 222.364 256.973 222.353C261.877 222.342 265.843 226.368 265.853 231.321C265.864 236.285 261.888 240.338 256.973 240.328ZM354.449 240.405C349.545 240.394 345.597 236.351 345.607 231.398C345.618 226.456 349.555 222.441 354.449 222.43C359.353 222.419 363.319 226.445 363.329 231.398C363.34 236.362 359.364 240.415 354.449 240.405ZM631.581 240.535C626.676 240.524 622.728 236.481 622.739 231.528C622.749 226.586 626.687 222.571 631.581 222.56C636.485 222.549 640.45 226.575 640.461 231.528C640.471 236.492 636.495 240.545 631.581 240.535Z" stroke="#F3F2FF" strokeWidth="3" strokeMiterlimit="2.3662" />

        </svg>
    )
})

export default ZeppelinBanner2
